(function(){"use strict";var e={9473:function(e,t,i){var o=i(9199);const n={id:"app"},a={id:"wrapper"};function s(e,t,i,s,c,l){const r=(0,o.up)("NotificationBell");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",a,[(0,o.Wm)(r)])])}const c={class:"fancy-container"},l={href:"#",class:"position-relative"},r=(0,o._)("i",{class:"fa fa-bell _gray",style:{"font-size":"24px"}},null,-1),d=(0,o._)("span",{class:"my-text btnLnk"},"Visits",-1);function u(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("div",{class:"notification-container",onClick:t[0]||(t[0]=(...e)=>s.toggleNotificationMenu&&s.toggleNotificationMenu(...e))},[(0,o._)("a",l,[r,d,(0,o._)("span",{class:(0,o.C_)(["position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger _reduced",{hidden:!e.notificationCount}])},(0,o.zw)(e.notificationCount),3)]),a.notifications.length>0?((0,o.wg)(),(0,o.j4)((0,o.LL)(a.showNotifications?"NotificationsList":"div"),{key:0,notifications:a.notifications,onClose:s.closeNotificationMenu,onMarkAsRead:s.handleMarkAsRead,onMarkAllRead:s.handleMarkAllRead},null,40,["notifications","onClose","onMarkAsRead","onMarkAllRead"])):(0,o.kq)("",!0)])])}const f={class:"notifications-list"},h=["onClick"],k={key:0,class:"see-more-link"};function p(e,t,i,n,a,s){return(0,o.wg)(),(0,o.iD)("div",{class:"notifications-wrapper",onClick:t[4]||(t[4]=(...e)=>s.handleMenuClick&&s.handleMenuClick(...e))},[(0,o._)("div",f,[(0,o._)("a",{href:"#",onClick:t[0]||(t[0]=(...e)=>s.markAllRead&&s.markAllRead(...e))},"Mark All as Read"),(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.notifications.slice(0,10),((e,i)=>((0,o.wg)(),(0,o.iD)("li",{key:i},[(0,o._)("div",{class:(0,o.C_)({notification:!0,bold:!e.is_read})},[(0,o._)("div",{onMouseover:t[1]||(t[1]=(...e)=>s.handleMouseOver&&s.handleMouseOver(...e)),onMouseleave:t[2]||(t[2]=(...e)=>s.handleMouseLeave&&s.handleMouseLeave(...e)),onClick:t=>s.markAsRead(e)},(0,o.zw)(e.message),41,h)],2)])))),128))]),i.notifications.length>10?((0,o.wg)(),(0,o.iD)("div",k,[(0,o._)("a",{href:"#",onClick:t[3]||(t[3]=(...e)=>s.showAllNotifications&&s.showAllNotifications(...e))},"See More")])):(0,o.kq)("",!0)])])}var v={props:["notifications"],data(){return{visibleNotifications:[],showMoreLink:!1}},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{showAllNotifications(){},handleMenuClick(e){e.stopPropagation()},markAllRead(){this.areAnyUnread()?(console.log("There are unread notifications."),this.$emit("mark-all-read")):console.log("All the notifications are already read.")},areAnyUnread(){return this.notifications.some((e=>!e.is_read))},markAsRead(e){e.is_read||this.$emit("mark-as-read",e.id)},handleClickOutside(e){this.$el.contains(e.target)||(this.visibleNotifications=[],this.showMoreLink=!1)},handleMouseOver(e){e.target.closest("li").querySelector(".notification").classList.add("hovered"),e.target.closest("li").querySelector(".notification").style.cursor="pointer"},handleMouseLeave(e){e.target.closest("li").querySelector(".notification").classList.remove("hovered"),e.target.closest("li").querySelector(".notification").style.cursor="default"}}},g=i(89);const m=(0,g.Z)(v,[["render",p]]);var b=m,w={data(){return{notifications:[],webSocket:null,showNotifications:!1}},mounted(){document.addEventListener("click",this.handleClickOutside),this.$el.querySelector(".notification-container").addEventListener("click",this.handleMenuClick),this.establishWebSocketConnection()},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside),this.$el.querySelector(".notification-container").removeEventListener("click",this.handleMenuClick)},methods:{toggleNotificationMenu(){this.showNotifications=!this.showNotifications,this.notificationCount>0&&this.webSocket.send(JSON.stringify({type:"mark.all.seen"}))},handleMarkAsRead(e){this.webSocket.send(JSON.stringify({type:"mark.one.read",id:e}))},handleMarkAllRead(){console.log("time to call the server!"),this.webSocket.send(JSON.stringify({type:"mark.all.read"}))},closeNotificationMenu(){this.showNotifications=!1},handleClickOutside(e){this.$el.contains(e.target)||(this.showNotifications=!1)},handleMenuClick(e){e.stopPropagation()},async establishWebSocketConnection(){this.webSocket=new WebSocket("ws://127.0.0.1:8001/websocket/ws/notifications/"),this.webSocket.onopen=()=>{console.log("WebSocket connection established!"),this.updateNotificationCount()},this.webSocket.onmessage=e=>{const t=JSON.parse(e.data);console.log(t),"notification.update"===t.type?(this.notificationCount=t.count,this.notifications=t.notifications.map((e=>({id:e.id,is_read:e.is_read,message:e.message})))):console.log("Notification count was not updated!")},this.webSocket.onclose=()=>{console.log("WebSocket connection closed.")}},updateNotificationCount(){this.webSocket.send(JSON.stringify({type:"update.notification.count"}))}},components:{NotificationsList:b}};const y=(0,g.Z)(w,[["render",u]]);var M=y,C={components:{NotificationBell:M}};const S=(0,g.Z)(C,[["render",s]]);var _=S;(0,o.ri)(_).mount("#app")}},t={};function i(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(t,o,n,a){if(!o){var s=1/0;for(d=0;d<e.length;d++){o=e[d][0],n=e[d][1],a=e[d][2];for(var c=!0,l=0;l<o.length;l++)(!1&a||s>=a)&&Object.keys(i.O).every((function(e){return i.O[e](o[l])}))?o.splice(l--,1):(c=!1,a<s&&(s=a));if(c){e.splice(d--,1);var r=n();void 0!==r&&(t=r)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,n,a]}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,a,s=o[0],c=o[1],l=o[2],r=0;if(s.some((function(t){return 0!==e[t]}))){for(n in c)i.o(c,n)&&(i.m[n]=c[n]);if(l)var d=l(i)}for(t&&t(o);r<s.length;r++)a=s[r],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},o=self["webpackChunkvue_autocomplete_component_example"]=self["webpackChunkvue_autocomplete_component_example"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(9473)}));o=i.O(o)})();
//# sourceMappingURL=app.js.map